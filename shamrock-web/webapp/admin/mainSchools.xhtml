<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
  xmlns:tr="http://myfaces.apache.org/trinidad" xmlns:a4j="http://richfaces.org/a4j"
  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="/templates/main.xhtml">

  <ui:define name="content">


    <!-- Next form contains the master list where each row contains 2 links to trigger
         update and remove.  Out side of the list, has a add link to add new school
         all links are ajaxed to render the school detail
         
         The school detail form is a full submit to trigger a full page reload
     -->
    
    <tr:form id="listWrapper" >

      <tr:panelCaptionGroup captionText="Main Schools">

        <tr:table id="list" value="#{mainSchoolList.mainSchools}" var="school" width="900px" rows="25"
          rowBandingInterval="1">

          <f:facet name="header">
            <tr:outputText value="Main Schools" />
          </f:facet>

          <tr:column width="7">
            <f:facet name="header">
              <tr:outputText value="Edit" />
            </f:facet>
            <tr:commandLink id="prepareEdit" partialSubmit="true" immediate="true"
              action="#{schoolDetail.prepareDetail}">
              <f:setPropertyActionListener value="#{school.id}" target="#{schoolDetail.selectedSchoolId}" />
              <f:setPropertyActionListener value="edit" target="#{schoolDetail.selectedSchoolAction}" />
              <tr:image id="edit" source="/images/edit.gif" border="0" />
            </tr:commandLink>
          </tr:column>

          <tr:column width="7">
            <f:facet name="header">
              <tr:outputText value="Del" />
            </f:facet>
            <tr:commandLink id="prepareDel" partialSubmit="true" immediate="true" action="#{schoolDetail.prepareDetail}">
              <f:setPropertyActionListener value="#{school.id}" target="#{schoolDetail.selectedSchoolId}" />
              <f:setPropertyActionListener value="del" target="#{schoolDetail.selectedSchoolAction}" />
              <tr:image id="del" source="/images/delete.gif" border="0" />
            </tr:commandLink>
          </tr:column>

          <tr:column sortProperty="name" sortable="true">
            <f:facet name="header">
              <h:outputText value="Name" />
            </f:facet>
            <h:outputText value="#{school.name}" />
          </tr:column>

          <tr:column sortProperty="description" sortable="true">
            <f:facet name="header">
              <h:outputText value="Description" />
            </f:facet>
            <tr:outputText value="#{school.description}" />
          </tr:column>

        </tr:table>

        <tr:spacer width="1" height="20" />

        <tr:commandLink id="prepareAdd" partialSubmit="true" text="add" action="#{schoolDetail.prepareDetail}"
          immediate="true">
          <f:setPropertyActionListener value="add" target="#{schoolDetail.selectedSchoolAction}" />
        </tr:commandLink>

      </tr:panelCaptionGroup>

    </tr:form>

    <rich:spacer width="1" height="20" />

    <tr:panelGroupLayout id="schoolDetails"
      partialTriggers=" :::::list:prepareEdit :::::list:prepareDel :::::prepareAdd persist">

      <tr:form id="detailWrapper" >

        <tr:panelCaptionGroup captionText="School Details" rendered="#{schoolDetail.rendered}">
          <tr:panelFormLayout rows="7" labelWidth="20%" fieldWidth="67%" >
            <h:inputHidden id="selectedSchoolId" value="#{schoolDetail.selectedSchoolId}" />
            <h:inputHidden id="selectedSchoolAction" value="#{schoolDetail.selectedSchoolAction}" />
            <tr:inputText columns="30" label="Name" value="#{schoolDetail.selectedSchool.name}"
              disabled="#{schoolDetail.readOnly}" />
            <tr:spacer width="1" height="10" />
            <tr:inputText columns="60" label="Description" value="#{schoolDetail.selectedSchool.description}"
              disabled="#{schoolDetail.readOnly}" />
            <tr:spacer width="1" height="10" />

            <tr:commandLink partialSubmit="false" id="persist" text="#{schoolDetail.selectedSchoolAction}"
              action="#{schoolDetail.persistSchool}" />
          </tr:panelFormLayout>
        </tr:panelCaptionGroup>

      </tr:form>

    </tr:panelGroupLayout>


  </ui:define>
</ui:composition>
</html>
